(function(e){var t={assertion:null,email:null,login_button_class:"browserid-login",logout_button_class:"browserid-logout",onlogin:null,onfail:null,onlogout:null,server:"login.php"},n={init:function(n){typeof n=="object"&&e.extend(t,n);this.addClass(t.login_button_class).on("click.login",r)},getEmail:function(){return t.email}},r=function(){var n=e(this);navigator.id.get(function(e){if(e){t.assertion=e;s.apply(n)}else typeof t.onfail=="function"&&t.onfail.apply(this)})},i=function(){navigator.id.logout();t.assertion=null;t.email=null;e(this).removeClass(t.logout_button_class).removeClass(t.login_button_class);n.init.apply(e(this));typeof t.onlogout=="function"&&t.onlogout.apply(this)},s=function(){var n=this;e.getJSON(t.server,{assertion:t.assertion},function(e){if(e.status&&e.status=="okay"){t.email=e.email;n.removeClass(t.login_button_class).addClass("options.logout_button_class").text("Logout ("+e.email+")");n.off("click.login").on("click.logout",i);typeof t.onlogin=="function"&&t.onlogin.apply(this)}else e.status!=="okay"&&typeof t.onfail=="function"&&t.onfail.apply(e)})};e.fn.browserID=function(e){if(n[e])return n[e].apply(this,Array.prototype.slice.call(arguments,1));if(typeof e=="object"||!e)return n.init.apply(this,arguments)}})(jQuery);